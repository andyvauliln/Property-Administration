[
  {
    "name": "01_file_payment_to_two_db_payments",
    "test_payment": [
      {
        "id": "bank-tc1",
        "amount": 3300.0,
        "payment_date": "2026-01-27",
        "notes": "Wire payment from Michael Steinhardt for apt. 630-205",
        "apartment_name": "630-205",
        "tenant_name": "Michael Steinhardt",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 6,
        "payment_type_type": "In",
        "apartment": 90,
        "merged_payment_key": "01/27/20263300Wire payment from Michael Steinhardt for apt. 630-205",
        "is_merged": false,
        "apartment_candidates": [
          "630-205"
        ],
        "tenant_candidates": [
          "Michael Steinhardt"
        ]
      }
    ],
    "expected_payments": [
      {
        "id": 16785,
        "amount": "1650.00",
        "payment_date": "2026-01-27",
        "payment_type": 6,
        "payment_type_name": "Rent (In)",
        "payment_type_obj": {
          "id": 6,
          "name": "Rent",
          "type": "In",
          "keywords": ""
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 6,
        "bank_name": "BA",
        "apartment": null,
        "apartment_name": "630-205",
        "booking": 1618,
        "tenant_name": "Michael Steinhardt",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB rent record A",
        "keywords": ""
      },
      {
        "id": 16786,
        "amount": "1650.00",
        "payment_date": "2026-01-27",
        "payment_type": 6,
        "payment_type_name": "Rent (In)",
        "payment_type_obj": {
          "id": 6,
          "name": "Rent",
          "type": "In",
          "keywords": ""
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 6,
        "bank_name": "BA",
        "apartment": null,
        "apartment_name": "630-205",
        "booking": 1618,
        "tenant_name": "Michael Steinhardt",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB rent record B",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16785,
          "amount": "1650.00",
          "payment_date": "2026-01-27",
          "payment_type": 6,
          "payment_type_name": "Rent (In)",
          "payment_type_obj": {
            "id": 6,
            "name": "Rent",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": null,
          "apartment_name": "630-205",
          "booking": 1618,
          "tenant_name": "Michael Steinhardt",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB rent record A",
          "keywords": ""
        },
        "score": 85.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $1650.00 [0] | Date: diff 0 days [20] | Apartment: 630-205 [20] | Tenant: Michael Steinhardt [20] | Bank: BA [0] | Payment Type: Rent (In) [20] | Payment Method: Wire [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 0.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 20.0,
          "payment_type": 20.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $1650.00",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "630-205",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "Michael Steinhardt",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Rent (In)",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Wire",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "high",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nCustom instructions:\nmerge this file payment into 2 db payments\n\nComposite selection:\n{\"amount_total\": 3300.0, \"date_from\": \"2026-01-27\", \"date_to\": \"2026-01-27\", \"direction\": \"In\", \"apartment_name\": \"630-205\", \"apartment_candidates\": [\"630-205\"], \"tenant_name\": \"Michael Steinhardt\", \"tenant_candidates\": [\"Michael Steinhardt\"], \"payment_method_name\": \"Wire\", \"payment_method_candidates\": [], \"bank_name\": \"BA\", \"bank_candidates\": [], \"notes_combined\": \"Wire payment from Michael Steinhardt for apt. 630-205\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16707, \"amount\": 3300.0, \"payment_date\": \"2026-01-27\", \"type\": \"In\", \"payment_type\": \"Rent\", \"apartment\": \"630-205\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB rent record A [Wire payment from Michael Steinhardt for apt. 630-205]\"}, {\"db_id\": 16708, \"amount\": 3300.0, \"payment_date\": \"2026-01-27\", \"type\": \"In\", \"payment_type\": \"Rent\", \"apartment\": \"630-205\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB rent record B [Wire payment from Michael Steinhardt for apt. 630-205]\"}, {\"db_id\": 16701, \"amount\": 3300.0, \"payment_date\": \"2026-01-27\", \"type\": \"In\", \"payment_type\": \"Rent\", \"apartment\": \"630-205\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB rent record A\"}, {\"db_id\": 16702, \"amount\": 3300.0, \"payment_date\": \"2026-01-27\", \"type\": \"In\", \"payment_type\": \"Rent\", \"apartment\": \"630-205\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB rent record B\"}, {\"db_id\": 3978, \"amount\": 3300.0, \"payment_date\": \"2026-02-01\", \"type\": \"In\", \"payment_type\": \"Rent\", \"apartment\": \"630-208\", \"tenant\": \"Anish Puri\", \"bank\": null, \"payment_method\": null, \"notes\": \"\"}, {\"db_id\": 3977, \"amount\": 3300.0, \"payment_date\": \"2026-01-01\", \"type\": \"In\", \"payment_type\": \"Rent\", \"apartment\": \"630-208\", \"tenant\": \"Anish Puri\", \"bank\": null, \"payment_method\": null, \"notes\": \"\"}, {\"db_id\": 2085, \"amount\": 3300.0, \"payment_date\": \"2026-01-01\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-311\", \"tenant\": null, \"bank\": null, \"payment_method\": null, \"notes\": \"Return of damage deposit\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": []
  },
  {
    "name": "02_multiple_file_payments_to_one_db_payment",
    "test_payment": [
      {
        "id": "bank-tc2-a",
        "amount": 1200.0,
        "payment_date": "2026-01-24",
        "notes": "Zelle partial payment Darren Wiggins 780-306",
        "apartment_name": "780-306",
        "tenant_name": "Darren Wiggins",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 1,
        "payment_method_name": "Zelle",
        "payment_type": 6,
        "payment_type_type": "In",
        "apartment": 59,
        "merged_payment_key": "01/24/20261200Zelle partial payment Darren Wiggins 780-306",
        "is_merged": false,
        "apartment_candidates": [
          "780-306"
        ],
        "tenant_candidates": [
          "Darren Wiggins"
        ]
      },
      {
        "id": "bank-tc2-b",
        "amount": 900.0,
        "payment_date": "2026-01-25",
        "notes": "Zelle partial payment Darren Wiggins 780-306 (2)",
        "apartment_name": "780-306",
        "tenant_name": "Darren Wiggins",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 1,
        "payment_method_name": "Zelle",
        "payment_type": 6,
        "payment_type_type": "In",
        "apartment": 59,
        "merged_payment_key": "01/25/2026900Zelle partial payment Darren Wiggins 780-306 (2)",
        "is_merged": false,
        "apartment_candidates": [
          "780-306"
        ],
        "tenant_candidates": [
          "Darren Wiggins"
        ]
      }
    ],
    "expected_payments": [
      {
        "id": 16787,
        "amount": "2100.00",
        "payment_date": "2026-01-25",
        "payment_type": 6,
        "payment_type_name": "Rent (In)",
        "payment_type_obj": {
          "id": 6,
          "name": "Rent",
          "type": "In",
          "keywords": ""
        },
        "payment_method": 1,
        "payment_method_name": "Zelle",
        "bank": 6,
        "bank_name": "BA",
        "apartment": null,
        "apartment_name": "780-306",
        "booking": 1619,
        "tenant_name": "Darren Wiggins",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB rent combined payment",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16787,
          "amount": "2100.00",
          "payment_date": "2026-01-25",
          "payment_type": 6,
          "payment_type_name": "Rent (In)",
          "payment_type_obj": {
            "id": 6,
            "name": "Rent",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 1,
          "payment_method_name": "Zelle",
          "bank": 6,
          "bank_name": "BA",
          "apartment": null,
          "apartment_name": "780-306",
          "booking": 1619,
          "tenant_name": "Darren Wiggins",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB rent combined payment",
          "keywords": ""
        },
        "score": 105.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $0.00 [20] | Date: diff 0 days [20] | Apartment: 780-306 [20] | Tenant: Darren Wiggins [20] | Bank: BA [0] | Payment Type: Rent (In) [20] | Payment Method: Zelle [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 20.0,
          "payment_type": 20.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $0.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "780-306",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "Darren Wiggins",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Rent (In)",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Zelle",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "high",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nCustom instructions:\nmerge these selected file payments into 1 db payment\n\nComposite selection:\n{\"amount_total\": 2100.0, \"date_from\": \"2026-01-24\", \"date_to\": \"2026-01-25\", \"direction\": \"In\", \"apartment_name\": \"780-306\", \"apartment_candidates\": [\"780-306\"], \"tenant_name\": \"Darren Wiggins\", \"tenant_candidates\": [\"Darren Wiggins\"], \"payment_method_name\": \"Zelle\", \"payment_method_candidates\": [], \"bank_name\": \"BA\", \"bank_candidates\": [], \"notes_combined\": \"Zelle partial payment Darren Wiggins 780-306 | Zelle partial payment Darren Wiggins 780-306 (2)\", \"selected_count\": 2}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16709, \"amount\": 2100.0, \"payment_date\": \"2026-01-24\", \"type\": \"In\", \"payment_type\": \"Rent\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB rent combined payment [Zelle partial payment Darren Wiggins 780-306 | Zelle partial payment Darren Wiggins 780-306 (2)]\"}, {\"db_id\": 16787, \"amount\": 2100.0, \"payment_date\": \"2026-01-25\", \"type\": \"In\", \"payment_type\": \"Rent\", \"apartment\": \"780-306\", \"tenant\": \"Darren Wiggins\", \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB rent combined payment\"}, {\"db_id\": 16703, \"amount\": 2100.0, \"payment_date\": \"2026-01-25\", \"type\": \"In\", \"payment_type\": \"Rent\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB rent combined payment\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16787,
          "amount": "2100.00",
          "payment_date": "2026-01-25",
          "payment_type": 6,
          "payment_type_name": "Rent (In)",
          "payment_type_obj": {
            "id": 6,
            "name": "Rent",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 1,
          "payment_method_name": "Zelle",
          "bank": 6,
          "bank_name": "BA",
          "apartment": null,
          "apartment_name": "780-306",
          "booking": 1619,
          "tenant_name": "Darren Wiggins",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB rent combined payment",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "03_apartment_match_beats_wrong_apartment",
    "test_payment": [
      {
        "id": "bank-tc3",
        "amount": 500.0,
        "payment_date": "2026-01-28",
        "notes": "Utility payment for 780-306",
        "apartment_name": "780-306",
        "tenant_name": "",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 2,
        "payment_type_type": "Out",
        "apartment": 59,
        "merged_payment_key": "01/28/2026500Utility payment for 780-306",
        "is_merged": false,
        "apartment_candidates": [
          "780-306"
        ],
        "tenant_candidates": []
      }
    ],
    "expected_payments": [
      {
        "id": 16788,
        "amount": "500.00",
        "payment_date": "2026-01-28",
        "payment_type": 2,
        "payment_type_name": "Other (Out)",
        "payment_type_obj": {
          "id": 2,
          "name": "Other",
          "type": "Out",
          "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 6,
        "bank_name": "BA",
        "apartment": 59,
        "apartment_name": "780-306",
        "booking": null,
        "tenant_name": "",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB utility for 780-306",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16788,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 2,
          "payment_type_name": "Other (Out)",
          "payment_type_obj": {
            "id": 2,
            "name": "Other",
            "type": "Out",
            "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB utility for 780-306",
          "keywords": ""
        },
        "score": 70.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $0.00 [20] | Date: diff 0 days [20] | Apartment: 780-306 [20] | Tenant: (none) [0] | Bank: BA [0] | Payment Type: Other (Out) [5] | Payment Method: Wire [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 0.0,
          "payment_type": 5.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $0.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "780-306",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "(none)",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Other (Out)",
            "score": 5.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Wire",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "high",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 500.0, \"date_from\": \"2026-01-28\", \"date_to\": \"2026-01-28\", \"direction\": \"Out\", \"apartment_name\": \"780-306\", \"apartment_candidates\": [\"780-306\"], \"tenant_name\": null, \"tenant_candidates\": [], \"payment_method_name\": \"Wire\", \"payment_method_candidates\": [], \"bank_name\": \"BA\", \"bank_candidates\": [], \"notes_combined\": \"Utility payment for 780-306\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16710, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility paymen\"}, {\"db_id\": 16704, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306\"}, {\"db_id\": 16788, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306\"}, {\"db_id\": 16705, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}, {\"db_id\": 16711, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}, {\"db_id\": 16789, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16788,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 2,
          "payment_type_name": "Other (Out)",
          "payment_type_obj": {
            "id": 2,
            "name": "Other",
            "type": "Out",
            "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB utility for 780-306",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "04_keywords_match_with_bank_penalty_still_matches",
    "test_payment": [
      {
        "id": "bank-tc4",
        "amount": 178.85,
        "payment_date": "2026-01-26",
        "notes": "City of West Palm payment for PH-402 garage",
        "apartment_name": "PH-402",
        "tenant_name": "Jane Keyword",
        "bank": 20,
        "bank_name": "TEST_NOT_BA_BANK",
        "payment_method": 12,
        "payment_method_name": "Check",
        "payment_type": 2,
        "payment_type_type": "Out",
        "apartment": 91,
        "merged_payment_key": "01/26/2026178.85City of West Palm payment for PH-402 garage",
        "is_merged": false,
        "apartment_candidates": [
          "PH-402"
        ],
        "tenant_candidates": [
          "Jane Keyword"
        ]
      }
    ],
    "expected_payments": [
      {
        "id": 16790,
        "amount": "178.85",
        "payment_date": "2026-01-26",
        "payment_type": 2,
        "payment_type_name": "Other (Out)",
        "payment_type_obj": {
          "id": 2,
          "name": "Other",
          "type": "Out",
          "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
        },
        "payment_method": 12,
        "payment_method_name": "Check",
        "bank": 20,
        "bank_name": "TEST_NOT_BA_BANK",
        "apartment": null,
        "apartment_name": "PH-402",
        "booking": 1620,
        "tenant_name": "Jane Keyword",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB city payment",
        "keywords": "garage,westpalm"
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16790,
          "amount": "178.85",
          "payment_date": "2026-01-26",
          "payment_type": 2,
          "payment_type_name": "Other (Out)",
          "payment_type_obj": {
            "id": 2,
            "name": "Other",
            "type": "Out",
            "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
          },
          "payment_method": 12,
          "payment_method_name": "Check",
          "bank": 20,
          "bank_name": "TEST_NOT_BA_BANK",
          "apartment": null,
          "apartment_name": "PH-402",
          "booking": 1620,
          "tenant_name": "Jane Keyword",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB city payment",
          "keywords": "garage,westpalm"
        },
        "score": 110.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $0.00 [20] | Date: diff 0 days [20] | Apartment: PH-402 [20] | Tenant: Jane Keyword [20] | Payment Type: Other (Out) [5] | Payment Method: Check [5] | Keywords: garage [50] | Bank: not BA (TEST_NOT_BA_BANK) [-30]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 20.0,
          "payment_type": 5.0,
          "payment_method": 5.0,
          "keywords": 50.0,
          "bank_penalty": -30.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $0.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "PH-402",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "Jane Keyword",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Other (Out)",
            "score": 5.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Check",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "garage",
            "score": 50.0,
            "max": 50,
            "matched": true
          }
        ],
        "penalties": [
          {
            "field": "bank",
            "label": "Bank",
            "value": "not BA (TEST_NOT_BA_BANK)",
            "penalty": -30.0
          }
        ],
        "matched_keywords": [
          "garage"
        ],
        "quality": "high",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 178.85, \"date_from\": \"2026-01-26\", \"date_to\": \"2026-01-26\", \"direction\": \"Out\", \"apartment_name\": \"PH-402\", \"apartment_candidates\": [\"PH-402\"], \"tenant_name\": \"Jane Keyword\", \"tenant_candidates\": [\"Jane Keyword\"], \"payment_method_name\": \"Check\", \"payment_method_candidates\": [], \"bank_name\": \"TEST_NOT_BA_BANK\", \"bank_candidates\": [], \"notes_combined\": \"City of West Palm payment for PH-402 garage\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16712, \"amount\": 178.85, \"payment_date\": \"2026-01-26\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"PH-402\", \"tenant\": null, \"bank\": \"TEST_NOT_BA_BANK\", \"payment_method\": \"Check\", \"notes\": \"DB city payment [City of West Palm payment for PH-402 garage]\"}, {\"db_id\": 16790, \"amount\": 178.85, \"payment_date\": \"2026-01-26\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"PH-402\", \"tenant\": \"Jane Keyword\", \"bank\": \"TEST_NOT_BA_BANK\", \"payment_method\": \"Check\", \"notes\": \"DB city payment\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16790,
          "amount": "178.85",
          "payment_date": "2026-01-26",
          "payment_type": 2,
          "payment_type_name": "Other (Out)",
          "payment_type_obj": {
            "id": 2,
            "name": "Other",
            "type": "Out",
            "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
          },
          "payment_method": 12,
          "payment_method_name": "Check",
          "bank": 20,
          "bank_name": "TEST_NOT_BA_BANK",
          "apartment": null,
          "apartment_name": "PH-402",
          "booking": 1620,
          "tenant_name": "Jane Keyword",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB city payment",
          "keywords": "garage,westpalm"
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "05_tenant_match_via_notes_token",
    "test_payment": [
      {
        "id": "bank-tc5",
        "amount": 1250.0,
        "payment_date": "2026-01-14",
        "notes": "ACH deposit Venmo transfer ref 88X - 450-110 Amy",
        "apartment_name": "450-110",
        "tenant_name": "",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 21,
        "payment_method_name": "ACH",
        "payment_type": 1,
        "payment_type_type": "In",
        "apartment": 92,
        "merged_payment_key": "01/14/20261250ACH deposit Venmo transfer ref 88X - 450-110 Amy",
        "is_merged": false,
        "apartment_candidates": [
          "450-110"
        ],
        "tenant_candidates": []
      }
    ],
    "expected_payments": [
      {
        "id": 16791,
        "amount": "1250.00",
        "payment_date": "2026-01-14",
        "payment_type": 1,
        "payment_type_name": "Other (In)",
        "payment_type_obj": {
          "id": 1,
          "name": "Other",
          "type": "In",
          "keywords": ""
        },
        "payment_method": 21,
        "payment_method_name": "ACH",
        "bank": 6,
        "bank_name": "BA",
        "apartment": null,
        "apartment_name": "450-110",
        "booking": 1621,
        "tenant_name": "Amy Split",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB deposit",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16791,
          "amount": "1250.00",
          "payment_date": "2026-01-14",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 21,
          "payment_method_name": "ACH",
          "bank": 6,
          "bank_name": "BA",
          "apartment": null,
          "apartment_name": "450-110",
          "booking": 1621,
          "tenant_name": "Amy Split",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB deposit",
          "keywords": ""
        },
        "score": 90.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $0.00 [20] | Date: diff 0 days [20] | Apartment: 450-110 [20] | Tenant: Amy Split [20] | Bank: BA [0] | Payment Type: Other (In) [5] | Payment Method: ACH [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 20.0,
          "payment_type": 5.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $0.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "450-110",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "Amy Split",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Other (In)",
            "score": 5.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "ACH",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "high",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 1250.0, \"date_from\": \"2026-01-14\", \"date_to\": \"2026-01-14\", \"direction\": \"In\", \"apartment_name\": \"450-110\", \"apartment_candidates\": [\"450-110\"], \"tenant_name\": null, \"tenant_candidates\": [], \"payment_method_name\": \"ACH\", \"payment_method_candidates\": [], \"bank_name\": \"BA\", \"bank_candidates\": [], \"notes_combined\": \"ACH deposit Venmo transfer ref 88X - 450-110 Amy\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16713, \"amount\": 1250.0, \"payment_date\": \"2026-01-14\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"450-110\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"ACH\", \"notes\": \"DB deposit [ACH deposit Venmo transfer ref 88X - 450-110 Amy]\"}, {\"db_id\": 16791, \"amount\": 1250.0, \"payment_date\": \"2026-01-14\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"450-110\", \"tenant\": \"Amy Split\", \"bank\": \"BA\", \"payment_method\": \"ACH\", \"notes\": \"DB deposit\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16791,
          "amount": "1250.00",
          "payment_date": "2026-01-14",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 21,
          "payment_method_name": "ACH",
          "bank": 6,
          "bank_name": "BA",
          "apartment": null,
          "apartment_name": "450-110",
          "booking": 1621,
          "tenant_name": "Amy Split",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB deposit",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "06_direction_filter_excludes_opposite_type",
    "test_payment": [
      {
        "id": "bank-tc6",
        "amount": 990.0,
        "payment_date": "2026-01-23",
        "notes": "Wire from vendor - refund",
        "apartment_name": "",
        "tenant_name": "",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 1,
        "payment_type_type": "In",
        "apartment": null,
        "merged_payment_key": "01/23/2026990Wire from vendor - refund",
        "is_merged": false,
        "apartment_candidates": [],
        "tenant_candidates": []
      }
    ],
    "expected_payments": [
      {
        "id": 16792,
        "amount": "990.00",
        "payment_date": "2026-01-23",
        "payment_type": 1,
        "payment_type_name": "Other (In)",
        "payment_type_obj": {
          "id": 1,
          "name": "Other",
          "type": "In",
          "keywords": ""
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 6,
        "bank_name": "BA",
        "apartment": null,
        "apartment_name": null,
        "booking": null,
        "tenant_name": "",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB refund",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16792,
          "amount": "990.00",
          "payment_date": "2026-01-23",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": null,
          "apartment_name": null,
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB refund",
          "keywords": ""
        },
        "score": 50.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $0.00 [20] | Date: diff 0 days [20] | Apartment: (none) [0] | Tenant: (none) [0] | Bank: BA [0] | Payment Type: Other (In) [5] | Payment Method: Wire [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 0.0,
          "tenant": 0.0,
          "payment_type": 5.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $0.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "(none)",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "(none)",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Other (In)",
            "score": 5.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Wire",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "medium",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 990.0, \"date_from\": \"2026-01-23\", \"date_to\": \"2026-01-23\", \"direction\": \"In\", \"apartment_name\": null, \"apartment_candidates\": [], \"tenant_name\": null, \"tenant_candidates\": [], \"payment_method_name\": \"Wire\", \"payment_method_candidates\": [], \"bank_name\": \"BA\", \"bank_candidates\": [], \"notes_combined\": \"Wire from vendor - refund\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16792, \"amount\": 990.0, \"payment_date\": \"2026-01-23\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": null, \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB refund\"}, {\"db_id\": 15194, \"amount\": 900.0, \"payment_date\": \"2026-01-15\", \"type\": \"In\", \"payment_type\": \"Damage Deposit\", \"apartment\": \"630-107\", \"tenant\": \"Whitney Woznick\", \"bank\": null, \"payment_method\": null, \"notes\": \"\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16792,
          "amount": "990.00",
          "payment_date": "2026-01-23",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": null,
          "apartment_name": null,
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB refund",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "07_payment_method_candidates_match",
    "test_payment": [
      {
        "id": "bank-tc7-a",
        "amount": 300.0,
        "payment_date": "2026-01-21",
        "notes": "Mixed methods selection - part 1",
        "apartment_name": "630-205",
        "tenant_name": "Michael Steinhardt",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 1,
        "payment_type_type": "In",
        "apartment": 90,
        "merged_payment_key": "01/21/2026300Mixed methods selection - part 1",
        "is_merged": false,
        "apartment_candidates": [
          "630-205"
        ],
        "tenant_candidates": [
          "Michael Steinhardt"
        ]
      },
      {
        "id": "bank-tc7-b",
        "amount": 300.0,
        "payment_date": "2026-01-21",
        "notes": "Mixed methods selection - part 2",
        "apartment_name": "630-205",
        "tenant_name": "Michael Steinhardt",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 1,
        "payment_method_name": "Zelle",
        "payment_type": 1,
        "payment_type_type": "In",
        "apartment": 90,
        "merged_payment_key": "01/21/2026300Mixed methods selection - part 2",
        "is_merged": false,
        "apartment_candidates": [
          "630-205"
        ],
        "tenant_candidates": [
          "Michael Steinhardt"
        ]
      }
    ],
    "expected_payments": [
      {
        "id": 16794,
        "amount": "600.00",
        "payment_date": "2026-01-21",
        "payment_type": 1,
        "payment_type_name": "Other (In)",
        "payment_type_obj": {
          "id": 1,
          "name": "Other",
          "type": "In",
          "keywords": ""
        },
        "payment_method": 1,
        "payment_method_name": "Zelle",
        "bank": 6,
        "bank_name": "BA",
        "apartment": null,
        "apartment_name": "630-205",
        "booking": 1618,
        "tenant_name": "Michael Steinhardt",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB mixed selection total",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16795,
          "amount": "330.00",
          "payment_date": "2026-01-22",
          "payment_type": 6,
          "payment_type_name": "Rent (In)",
          "payment_type_obj": {
            "id": 6,
            "name": "Rent",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 1,
          "payment_method_name": "Zelle",
          "bank": 6,
          "bank_name": "BA",
          "apartment": null,
          "apartment_name": "630-205",
          "booking": 1618,
          "tenant_name": "Michael Steinhardt",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB pending should rank higher",
          "keywords": ""
        },
        "score": 105.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $270.00 [20] | Date: diff 1 days [20] | Apartment: 630-205 [20] | Tenant: Michael Steinhardt [20] | Bank: BA [0] | Payment Type: Rent (In) [20] | Payment Method: Zelle [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 20.0,
          "payment_type": 20.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $270.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 1 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "630-205",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "Michael Steinhardt",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Rent (In)",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Zelle",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "high",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 600.0, \"date_from\": \"2026-01-21\", \"date_to\": \"2026-01-21\", \"direction\": \"In\", \"apartment_name\": \"630-205\", \"apartment_candidates\": [\"630-205\"], \"tenant_name\": \"Michael Steinhardt\", \"tenant_candidates\": [\"Michael Steinhardt\"], \"payment_method_name\": null, \"payment_method_candidates\": [\"Wire\", \"Zelle\"], \"bank_name\": \"BA\", \"bank_candidates\": [], \"notes_combined\": \"Mixed methods selection - part 1 | Mixed methods selection - part 2\", \"selected_count\": 2}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16716, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}, {\"db_id\": 16794, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": \"Michael Steinhardt\", \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total\"}, {\"db_id\": 16717, \"amount\": 330.0, \"payment_date\": \"2026-01-22\", \"type\": \"In\", \"payment_type\": \"Rent\", \"apartment\": \"630-205\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB pending should rank higher [Zelle - partial payment 630-205]\"}, {\"db_id\": 16795, \"amount\": 330.0, \"payment_date\": \"2026-01-22\", \"type\": \"In\", \"payment_type\": \"Rent\", \"apartment\": \"630-205\", \"tenant\": \"Michael Steinhardt\", \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB pending should rank higher\"}, {\"db_id\": 16796, \"amount\": 330.0, \"payment_date\": \"2026-01-22\", \"type\": \"In\", \"payment_type\": \"Rent\", \"apartment\": \"630-205\", \"tenant\": \"Michael Steinhardt\", \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB merged should rank lower\"}, {\"db_id\": 16714, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"TEST_NOT_BA_BANK\", \"payment_method\": \"Wire\", \"notes\": \"DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variat\"}, {\"db_id\": 16718, \"amount\": 330.0, \"payment_date\": \"2026-01-22\", \"type\": \"In\", \"payment_type\": \"Rent\", \"apartment\": \"630-205\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB merged should rank lower\"}, {\"db_id\": 16797, \"amount\": 390.0, \"payment_date\": \"2026-01-20\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": \"Darren Wiggins\", \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB scaled-delta target\"}, {\"db_id\": 16719, \"amount\": 300.0, \"payment_date\": \"2026-01-20\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB scaled-delta target [Split 1/3 | Split 2/3 | Split 3/3]\"}, {\"db_id\": 15194, \"amount\": 900.0, \"payment_date\": \"2026-01-15\", \"type\": \"In\", \"payment_type\": \"Damage Deposit\", \"apartment\": \"630-107\", \"tenant\": \"Whitney Woznick\", \"bank\": null, \"payment_method\": null, \"notes\": \"\"}, {\"db_id\": 16792, \"amount\": 990.0, \"payment_date\": \"2026-01-23\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": null, \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB refund [Wire from vendor - refund]\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16794,
          "amount": "600.00",
          "payment_date": "2026-01-21",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 1,
          "payment_method_name": "Zelle",
          "bank": 6,
          "bank_name": "BA",
          "apartment": null,
          "apartment_name": "630-205",
          "booking": 1618,
          "tenant_name": "Michael Steinhardt",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB mixed selection total",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "08_status_penalty_prefers_pending",
    "test_payment": [
      {
        "id": "bank-tc8",
        "amount": 330.0,
        "payment_date": "2026-01-22",
        "notes": "Zelle - partial payment 630-205",
        "apartment_name": "630-205",
        "tenant_name": "Michael Steinhardt",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 1,
        "payment_method_name": "Zelle",
        "payment_type": 6,
        "payment_type_type": "In",
        "apartment": 90,
        "merged_payment_key": "01/22/2026330Zelle - partial payment 630-205",
        "is_merged": false,
        "apartment_candidates": [
          "630-205"
        ],
        "tenant_candidates": [
          "Michael Steinhardt"
        ]
      }
    ],
    "expected_payments": [
      {
        "id": 16795,
        "amount": "330.00",
        "payment_date": "2026-01-22",
        "payment_type": 6,
        "payment_type_name": "Rent (In)",
        "payment_type_obj": {
          "id": 6,
          "name": "Rent",
          "type": "In",
          "keywords": ""
        },
        "payment_method": 1,
        "payment_method_name": "Zelle",
        "bank": 6,
        "bank_name": "BA",
        "apartment": null,
        "apartment_name": "630-205",
        "booking": 1618,
        "tenant_name": "Michael Steinhardt",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB pending should rank higher",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16795,
          "amount": "330.00",
          "payment_date": "2026-01-22",
          "payment_type": 6,
          "payment_type_name": "Rent (In)",
          "payment_type_obj": {
            "id": 6,
            "name": "Rent",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 1,
          "payment_method_name": "Zelle",
          "bank": 6,
          "bank_name": "BA",
          "apartment": null,
          "apartment_name": "630-205",
          "booking": 1618,
          "tenant_name": "Michael Steinhardt",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB pending should rank higher",
          "keywords": ""
        },
        "score": 105.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $0.00 [20] | Date: diff 0 days [20] | Apartment: 630-205 [20] | Tenant: Michael Steinhardt [20] | Bank: BA [0] | Payment Type: Rent (In) [20] | Payment Method: Zelle [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 20.0,
          "payment_type": 20.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $0.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "630-205",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "Michael Steinhardt",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Rent (In)",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Zelle",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "high",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 330.0, \"date_from\": \"2026-01-22\", \"date_to\": \"2026-01-22\", \"direction\": \"In\", \"apartment_name\": \"630-205\", \"apartment_candidates\": [\"630-205\"], \"tenant_name\": \"Michael Steinhardt\", \"tenant_candidates\": [\"Michael Steinhardt\"], \"payment_method_name\": \"Zelle\", \"payment_method_candidates\": [], \"bank_name\": \"BA\", \"bank_candidates\": [], \"notes_combined\": \"Zelle - partial payment 630-205\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16717, \"amount\": 330.0, \"payment_date\": \"2026-01-22\", \"type\": \"In\", \"payment_type\": \"Rent\", \"apartment\": \"630-205\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB pending should rank higher [Zelle - partial payment 630-205]\"}, {\"db_id\": 16795, \"amount\": 330.0, \"payment_date\": \"2026-01-22\", \"type\": \"In\", \"payment_type\": \"Rent\", \"apartment\": \"630-205\", \"tenant\": \"Michael Steinhardt\", \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB pending should rank higher\"}, {\"db_id\": 16796, \"amount\": 330.0, \"payment_date\": \"2026-01-22\", \"type\": \"In\", \"payment_type\": \"Rent\", \"apartment\": \"630-205\", \"tenant\": \"Michael Steinhardt\", \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB merged should rank lower\"}, {\"db_id\": 16718, \"amount\": 330.0, \"payment_date\": \"2026-01-22\", \"type\": \"In\", \"payment_type\": \"Rent\", \"apartment\": \"630-205\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB merged should rank lower\"}, {\"db_id\": 16719, \"amount\": 300.0, \"payment_date\": \"2026-01-20\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB scaled-delta target [Split 1/3 | Split 2/3 | Split 3/3]\"}, {\"db_id\": 16797, \"amount\": 390.0, \"payment_date\": \"2026-01-20\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": \"Darren Wiggins\", \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB scaled-delta target\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16795,
          "amount": "330.00",
          "payment_date": "2026-01-22",
          "payment_type": 6,
          "payment_type_name": "Rent (In)",
          "payment_type_obj": {
            "id": 6,
            "name": "Rent",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 1,
          "payment_method_name": "Zelle",
          "bank": 6,
          "bank_name": "BA",
          "apartment": null,
          "apartment_name": "630-205",
          "booking": 1618,
          "tenant_name": "Michael Steinhardt",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB pending should rank higher",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "09_amount_delta_scales_with_selection_count",
    "test_payment": [
      {
        "id": "bank-tc9-a",
        "amount": 100.0,
        "payment_date": "2026-01-20",
        "notes": "Split 1/3",
        "apartment_name": "780-306",
        "tenant_name": "Darren Wiggins",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 1,
        "payment_method_name": "Zelle",
        "payment_type": 1,
        "payment_type_type": "In",
        "apartment": 59,
        "merged_payment_key": "01/20/2026100Split 1/3",
        "is_merged": false,
        "apartment_candidates": [
          "780-306"
        ],
        "tenant_candidates": [
          "Darren Wiggins"
        ]
      },
      {
        "id": "bank-tc9-b",
        "amount": 100.0,
        "payment_date": "2026-01-20",
        "notes": "Split 2/3",
        "apartment_name": "780-306",
        "tenant_name": "Darren Wiggins",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 1,
        "payment_method_name": "Zelle",
        "payment_type": 1,
        "payment_type_type": "In",
        "apartment": 59,
        "merged_payment_key": "01/20/2026100Split 2/3",
        "is_merged": false,
        "apartment_candidates": [
          "780-306"
        ],
        "tenant_candidates": [
          "Darren Wiggins"
        ]
      },
      {
        "id": "bank-tc9-c",
        "amount": 100.0,
        "payment_date": "2026-01-20",
        "notes": "Split 3/3",
        "apartment_name": "780-306",
        "tenant_name": "Darren Wiggins",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 1,
        "payment_method_name": "Zelle",
        "payment_type": 1,
        "payment_type_type": "In",
        "apartment": 59,
        "merged_payment_key": "01/20/2026100Split 3/3",
        "is_merged": false,
        "apartment_candidates": [
          "780-306"
        ],
        "tenant_candidates": [
          "Darren Wiggins"
        ]
      }
    ],
    "expected_payments": [
      {
        "id": 16797,
        "amount": "390.00",
        "payment_date": "2026-01-20",
        "payment_type": 1,
        "payment_type_name": "Other (In)",
        "payment_type_obj": {
          "id": 1,
          "name": "Other",
          "type": "In",
          "keywords": ""
        },
        "payment_method": 1,
        "payment_method_name": "Zelle",
        "bank": 6,
        "bank_name": "BA",
        "apartment": null,
        "apartment_name": "780-306",
        "booking": 1619,
        "tenant_name": "Darren Wiggins",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB scaled-delta target",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16797,
          "amount": "390.00",
          "payment_date": "2026-01-20",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 1,
          "payment_method_name": "Zelle",
          "bank": 6,
          "bank_name": "BA",
          "apartment": null,
          "apartment_name": "780-306",
          "booking": 1619,
          "tenant_name": "Darren Wiggins",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB scaled-delta target",
          "keywords": ""
        },
        "score": 90.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $90.00 [20] | Date: diff 0 days [20] | Apartment: 780-306 [20] | Tenant: Darren Wiggins [20] | Bank: BA [0] | Payment Type: Other (In) [5] | Payment Method: Zelle [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 20.0,
          "payment_type": 5.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $90.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "780-306",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "Darren Wiggins",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Other (In)",
            "score": 5.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Zelle",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "high",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 300.0, \"date_from\": \"2026-01-20\", \"date_to\": \"2026-01-20\", \"direction\": \"In\", \"apartment_name\": \"780-306\", \"apartment_candidates\": [\"780-306\"], \"tenant_name\": \"Darren Wiggins\", \"tenant_candidates\": [\"Darren Wiggins\"], \"payment_method_name\": \"Zelle\", \"payment_method_candidates\": [], \"bank_name\": \"BA\", \"bank_candidates\": [], \"notes_combined\": \"Split 1/3 | Split 2/3 | Split 3/3\", \"selected_count\": 3}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16719, \"amount\": 300.0, \"payment_date\": \"2026-01-20\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB scaled-delta target [Split 1/3 | Split 2/3 | Split 3/3]\"}, {\"db_id\": 16797, \"amount\": 390.0, \"payment_date\": \"2026-01-20\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": \"Darren Wiggins\", \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB scaled-delta target\"}, {\"db_id\": 16717, \"amount\": 330.0, \"payment_date\": \"2026-01-22\", \"type\": \"In\", \"payment_type\": \"Rent\", \"apartment\": \"630-205\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB pending should rank higher [Zelle - partial payment 630-205]\"}, {\"db_id\": 16795, \"amount\": 330.0, \"payment_date\": \"2026-01-22\", \"type\": \"In\", \"payment_type\": \"Rent\", \"apartment\": \"630-205\", \"tenant\": \"Michael Steinhardt\", \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB pending should rank higher [Zelle - partial payment 630-205]\"}, {\"db_id\": 16718, \"amount\": 330.0, \"payment_date\": \"2026-01-22\", \"type\": \"In\", \"payment_type\": \"Rent\", \"apartment\": \"630-205\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB merged should rank lower\"}, {\"db_id\": 16796, \"amount\": 330.0, \"payment_date\": \"2026-01-22\", \"type\": \"In\", \"payment_type\": \"Rent\", \"apartment\": \"630-205\", \"tenant\": \"Michael Steinhardt\", \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB merged should rank lower\"}, {\"db_id\": 16714, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"TEST_NOT_BA_BANK\", \"payment_method\": \"Wire\", \"notes\": \"DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variat\"}, {\"db_id\": 16716, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}, {\"db_id\": 16794, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": \"Michael Steinhardt\", \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}, {\"db_id\": 15194, \"amount\": 900.0, \"payment_date\": \"2026-01-15\", \"type\": \"In\", \"payment_type\": \"Damage Deposit\", \"apartment\": \"630-107\", \"tenant\": \"Whitney Woznick\", \"bank\": null, \"payment_method\": null, \"notes\": \"\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16797,
          "amount": "390.00",
          "payment_date": "2026-01-20",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 1,
          "payment_method_name": "Zelle",
          "bank": 6,
          "bank_name": "BA",
          "apartment": null,
          "apartment_name": "780-306",
          "booking": 1619,
          "tenant_name": "Darren Wiggins",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB scaled-delta target",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "10_variation_10",
    "test_payment": [
      {
        "id": "bank-tc10",
        "amount": 500.0,
        "payment_date": "2026-01-28",
        "notes": "Variation 10 - Utility payment for 780-306",
        "apartment_name": "780-306",
        "tenant_name": "Jane Keyword",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 1,
        "payment_type_type": "In",
        "apartment": 59,
        "merged_payment_key": "01/28/2026500Variation 10 - Utility payment for 780-306",
        "is_merged": false,
        "apartment_candidates": [
          "780-306"
        ],
        "tenant_candidates": [
          "Jane Keyword"
        ]
      }
    ],
    "expected_payments": [
      {
        "id": 16792,
        "amount": "990.00",
        "payment_date": "2026-01-23",
        "payment_type": 1,
        "payment_type_name": "Other (In)",
        "payment_type_obj": {
          "id": 1,
          "name": "Other",
          "type": "In",
          "keywords": ""
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 6,
        "bank_name": "BA",
        "apartment": null,
        "apartment_name": null,
        "booking": null,
        "tenant_name": "",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB refund [Wire from vendor - refund]",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 6091,
          "amount": "5313.00",
          "payment_date": "2026-02-01",
          "payment_type": 6,
          "payment_type_name": "Rent (In)",
          "payment_type_obj": {
            "id": 6,
            "name": "Rent",
            "type": "In",
            "keywords": ""
          },
          "payment_method": null,
          "payment_method_name": null,
          "bank": null,
          "bank_name": null,
          "apartment": null,
          "apartment_name": "630-202",
          "booking": 1102,
          "tenant_name": "Steve Betz",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "",
          "keywords": ""
        },
        "score": 40.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $4813.00 [0] | Date: diff 4 days [20] | Apartment: 630-202 [0] | Tenant: Steve Betz [0] | Bank: (none/BA) [0] | Payment Type: Rent (In) [20] | Payment Method: (none) [0] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 0.0,
          "date": 20.0,
          "apartment": 0.0,
          "tenant": 0.0,
          "payment_type": 20.0,
          "payment_method": 0.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $4813.00",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 4 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "630-202",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "Steve Betz",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "(none/BA)",
            "score": 0,
            "max": 0,
            "matched": false
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Rent (In)",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "(none)",
            "score": 0.0,
            "max": 5,
            "matched": false
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "medium",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 500.0, \"date_from\": \"2026-01-28\", \"date_to\": \"2026-01-28\", \"direction\": \"In\", \"apartment_name\": \"780-306\", \"apartment_candidates\": [\"780-306\"], \"tenant_name\": \"Jane Keyword\", \"tenant_candidates\": [\"Jane Keyword\"], \"payment_method_name\": \"Wire\", \"payment_method_candidates\": [], \"bank_name\": \"BA\", \"bank_candidates\": [], \"notes_combined\": \"Variation 10 - Utility payment for 780-306\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16714, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"TEST_NOT_BA_BANK\", \"payment_method\": \"Wire\", \"notes\": \"DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variat\"}, {\"db_id\": 16716, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}, {\"db_id\": 16794, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": \"Michael Steinhardt\", \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": []
  },
  {
    "name": "11_variation_11",
    "test_payment": [
      {
        "id": "bank-tc11",
        "amount": 500.0,
        "payment_date": "2026-01-28",
        "notes": "Variation 11 - Utility payment for 780-306 garage",
        "apartment_name": "780-306",
        "tenant_name": "",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 2,
        "payment_type_type": "Out",
        "apartment": 59,
        "merged_payment_key": "01/28/2026500Variation 11 - Utility payment for 780-306 garage",
        "is_merged": false,
        "apartment_candidates": [
          "780-306"
        ],
        "tenant_candidates": []
      }
    ],
    "expected_payments": [
      {
        "id": 16788,
        "amount": "500.00",
        "payment_date": "2026-01-28",
        "payment_type": 2,
        "payment_type_name": "Other (Out)",
        "payment_type_obj": {
          "id": 2,
          "name": "Other",
          "type": "Out",
          "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 6,
        "bank_name": "BA",
        "apartment": 59,
        "apartment_name": "780-306",
        "booking": null,
        "tenant_name": "",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB utility for 780-306 [Utility payment for 780-306]",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16788,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 2,
          "payment_type_name": "Other (Out)",
          "payment_type_obj": {
            "id": 2,
            "name": "Other",
            "type": "Out",
            "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB utility for 780-306 [Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 70.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $0.00 [20] | Date: diff 0 days [20] | Apartment: 780-306 [20] | Tenant: (none) [0] | Bank: BA [0] | Payment Type: Other (Out) [5] | Payment Method: Wire [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 0.0,
          "payment_type": 5.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $0.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "780-306",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "(none)",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Other (Out)",
            "score": 5.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Wire",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "high",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 500.0, \"date_from\": \"2026-01-28\", \"date_to\": \"2026-01-28\", \"direction\": \"Out\", \"apartment_name\": \"780-306\", \"apartment_candidates\": [\"780-306\"], \"tenant_name\": null, \"tenant_candidates\": [], \"payment_method_name\": \"Wire\", \"payment_method_candidates\": [], \"bank_name\": \"BA\", \"bank_candidates\": [], \"notes_combined\": \"Variation 11 - Utility payment for 780-306 garage\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16710, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility paymen\"}, {\"db_id\": 16788, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306 [Utility payment for 780-306]\"}, {\"db_id\": 16704, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306\"}, {\"db_id\": 16705, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}, {\"db_id\": 16711, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}, {\"db_id\": 16789, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16788,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 2,
          "payment_type_name": "Other (Out)",
          "payment_type_obj": {
            "id": 2,
            "name": "Other",
            "type": "Out",
            "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB utility for 780-306 [Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "12_variation_12",
    "test_payment": [
      {
        "id": "bank-tc12",
        "amount": 500.0,
        "payment_date": "2026-01-28",
        "notes": "Variation 12 - Utility payment for 780-306",
        "apartment_name": "780-306",
        "tenant_name": "",
        "bank": 20,
        "bank_name": "TEST_NOT_BA_BANK",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 1,
        "payment_type_type": "In",
        "apartment": 59,
        "merged_payment_key": "01/28/2026500Variation 12 - Utility payment for 780-306",
        "is_merged": false,
        "apartment_candidates": [
          "780-306"
        ],
        "tenant_candidates": []
      }
    ],
    "expected_payments": [
      {
        "id": 16792,
        "amount": "500.00",
        "payment_date": "2026-01-28",
        "payment_type": 1,
        "payment_type_name": "Other (In)",
        "payment_type_obj": {
          "id": 1,
          "name": "Other",
          "type": "In",
          "keywords": ""
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 6,
        "bank_name": "BA",
        "apartment": 59,
        "apartment_name": "780-306",
        "booking": null,
        "tenant_name": "",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306]",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16792,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 70.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $0.00 [20] | Date: diff 0 days [20] | Apartment: 780-306 [20] | Tenant: (none) [0] | Bank: BA [0] | Payment Type: Other (In) [5] | Payment Method: Wire [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 0.0,
          "payment_type": 5.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $0.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "780-306",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "(none)",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Other (In)",
            "score": 5.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Wire",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "high",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 500.0, \"date_from\": \"2026-01-28\", \"date_to\": \"2026-01-28\", \"direction\": \"In\", \"apartment_name\": \"780-306\", \"apartment_candidates\": [\"780-306\"], \"tenant_name\": null, \"tenant_candidates\": [], \"payment_method_name\": \"Wire\", \"payment_method_candidates\": [], \"bank_name\": \"TEST_NOT_BA_BANK\", \"bank_candidates\": [], \"notes_combined\": \"Variation 12 - Utility payment for 780-306\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16714, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"TEST_NOT_BA_BANK\", \"payment_method\": \"Wire\", \"notes\": \"DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variat\"}, {\"db_id\": 16792, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306]\"}, {\"db_id\": 16716, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}, {\"db_id\": 16794, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": \"Michael Steinhardt\", \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16792,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "13_variation_13",
    "test_payment": [
      {
        "id": "bank-tc13",
        "amount": 500.0,
        "payment_date": "2026-01-28",
        "notes": "Variation 13 - Utility payment for 780-306",
        "apartment_name": "780-306",
        "tenant_name": "",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 2,
        "payment_type_type": "Out",
        "apartment": 59,
        "merged_payment_key": "01/28/2026500Variation 13 - Utility payment for 780-306",
        "is_merged": false,
        "apartment_candidates": [
          "780-306"
        ],
        "tenant_candidates": []
      }
    ],
    "expected_payments": [
      {
        "id": 16788,
        "amount": "500.00",
        "payment_date": "2026-01-28",
        "payment_type": 2,
        "payment_type_name": "Other (Out)",
        "payment_type_obj": {
          "id": 2,
          "name": "Other",
          "type": "Out",
          "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 6,
        "bank_name": "BA",
        "apartment": 59,
        "apartment_name": "780-306",
        "booking": null,
        "tenant_name": "",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage]",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16788,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 2,
          "payment_type_name": "Other (Out)",
          "payment_type_obj": {
            "id": 2,
            "name": "Other",
            "type": "Out",
            "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage]",
          "keywords": ""
        },
        "score": 70.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $0.00 [20] | Date: diff 0 days [20] | Apartment: 780-306 [20] | Tenant: (none) [0] | Bank: BA [0] | Payment Type: Other (Out) [5] | Payment Method: Wire [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 0.0,
          "payment_type": 5.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $0.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "780-306",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "(none)",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Other (Out)",
            "score": 5.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Wire",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "high",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 500.0, \"date_from\": \"2026-01-28\", \"date_to\": \"2026-01-28\", \"direction\": \"Out\", \"apartment_name\": \"780-306\", \"apartment_candidates\": [\"780-306\"], \"tenant_name\": null, \"tenant_candidates\": [], \"payment_method_name\": \"Wire\", \"payment_method_candidates\": [], \"bank_name\": \"BA\", \"bank_candidates\": [], \"notes_combined\": \"Variation 13 - Utility payment for 780-306\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16710, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility paymen\"}, {\"db_id\": 16788, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage]\"}, {\"db_id\": 16704, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306\"}, {\"db_id\": 16705, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}, {\"db_id\": 16711, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}, {\"db_id\": 16789, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16788,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 2,
          "payment_type_name": "Other (Out)",
          "payment_type_obj": {
            "id": 2,
            "name": "Other",
            "type": "Out",
            "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage]",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "14_variation_14",
    "test_payment": [
      {
        "id": "bank-tc14",
        "amount": 500.0,
        "payment_date": "2026-01-28",
        "notes": "Variation 14 - Utility payment for 780-306",
        "apartment_name": "PH-402",
        "tenant_name": "",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 1,
        "payment_type_type": "In",
        "apartment": 91,
        "merged_payment_key": "01/28/2026500Variation 14 - Utility payment for 780-306",
        "is_merged": false,
        "apartment_candidates": [
          "PH-402",
          "780-306"
        ],
        "tenant_candidates": []
      }
    ],
    "expected_payments": [
      {
        "id": 16792,
        "amount": "500.00",
        "payment_date": "2026-01-28",
        "payment_type": 1,
        "payment_type_name": "Other (In)",
        "payment_type_obj": {
          "id": 1,
          "name": "Other",
          "type": "In",
          "keywords": ""
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 20,
        "bank_name": "TEST_NOT_BA_BANK",
        "apartment": 59,
        "apartment_name": "780-306",
        "booking": null,
        "tenant_name": "",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306]",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16792,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 20,
          "bank_name": "TEST_NOT_BA_BANK",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 40.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $0.00 [20] | Date: diff 0 days [20] | Apartment: 780-306 [20] | Tenant: (none) [0] | Payment Type: Other (In) [5] | Payment Method: Wire [5] | Keywords: (none) [0] | Bank: not BA (TEST_NOT_BA_BANK) [-30]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 0.0,
          "payment_type": 5.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": -30.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $0.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "780-306",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "(none)",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Other (In)",
            "score": 5.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Wire",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [
          {
            "field": "bank",
            "label": "Bank",
            "value": "not BA (TEST_NOT_BA_BANK)",
            "penalty": -30.0
          }
        ],
        "matched_keywords": [],
        "quality": "medium",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 500.0, \"date_from\": \"2026-01-28\", \"date_to\": \"2026-01-28\", \"direction\": \"In\", \"apartment_name\": null, \"apartment_candidates\": [\"PH-402\", \"780-306\"], \"tenant_name\": null, \"tenant_candidates\": [], \"payment_method_name\": \"Wire\", \"payment_method_candidates\": [], \"bank_name\": \"BA\", \"bank_candidates\": [], \"notes_combined\": \"Variation 14 - Utility payment for 780-306\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16714, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"TEST_NOT_BA_BANK\", \"payment_method\": \"Wire\", \"notes\": \"DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variat\"}, {\"db_id\": 16792, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"TEST_NOT_BA_BANK\", \"payment_method\": \"Wire\", \"notes\": \"DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306]\"}, {\"db_id\": 16716, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}, {\"db_id\": 16794, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": \"Michael Steinhardt\", \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16792,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 20,
          "bank_name": "TEST_NOT_BA_BANK",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "15_variation_15",
    "test_payment": [
      {
        "id": "bank-tc15",
        "amount": 500.0,
        "payment_date": "2026-01-28",
        "notes": "Variation 15 - Utility payment for 780-306",
        "apartment_name": "780-306",
        "tenant_name": "Jane Keyword",
        "bank": 20,
        "bank_name": "TEST_NOT_BA_BANK",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 2,
        "payment_type_type": "Out",
        "apartment": 59,
        "merged_payment_key": "01/28/2026500Variation 15 - Utility payment for 780-306",
        "is_merged": false,
        "apartment_candidates": [
          "780-306"
        ],
        "tenant_candidates": [
          "Jane Keyword"
        ]
      }
    ],
    "expected_payments": [
      {
        "id": 16788,
        "amount": "500.00",
        "payment_date": "2026-01-28",
        "payment_type": 2,
        "payment_type_name": "Other (Out)",
        "payment_type_obj": {
          "id": 2,
          "name": "Other",
          "type": "Out",
          "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 6,
        "bank_name": "BA",
        "apartment": 59,
        "apartment_name": "780-306",
        "booking": null,
        "tenant_name": "",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306]",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16788,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 2,
          "payment_type_name": "Other (Out)",
          "payment_type_obj": {
            "id": 2,
            "name": "Other",
            "type": "Out",
            "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 70.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $0.00 [20] | Date: diff 0 days [20] | Apartment: 780-306 [20] | Tenant: (none) [0] | Bank: BA [0] | Payment Type: Other (Out) [5] | Payment Method: Wire [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 0.0,
          "payment_type": 5.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $0.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "780-306",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "(none)",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Other (Out)",
            "score": 5.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Wire",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "high",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 500.0, \"date_from\": \"2026-01-28\", \"date_to\": \"2026-01-28\", \"direction\": \"Out\", \"apartment_name\": \"780-306\", \"apartment_candidates\": [\"780-306\"], \"tenant_name\": \"Jane Keyword\", \"tenant_candidates\": [\"Jane Keyword\"], \"payment_method_name\": \"Wire\", \"payment_method_candidates\": [], \"bank_name\": \"TEST_NOT_BA_BANK\", \"bank_candidates\": [], \"notes_combined\": \"Variation 15 - Utility payment for 780-306\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16710, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility paymen\"}, {\"db_id\": 16788, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306]\"}, {\"db_id\": 16704, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306\"}, {\"db_id\": 16705, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}, {\"db_id\": 16711, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}, {\"db_id\": 16789, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16788,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 2,
          "payment_type_name": "Other (Out)",
          "payment_type_obj": {
            "id": 2,
            "name": "Other",
            "type": "Out",
            "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "16_variation_16",
    "test_payment": [
      {
        "id": "bank-tc16",
        "amount": 500.0,
        "payment_date": "2026-01-28",
        "notes": "Variation 16 - Utility payment for 780-306",
        "apartment_name": "780-306",
        "tenant_name": "",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 1,
        "payment_type_type": "In",
        "apartment": 59,
        "merged_payment_key": "01/28/2026500Variation 16 - Utility payment for 780-306",
        "is_merged": false,
        "apartment_candidates": [
          "780-306"
        ],
        "tenant_candidates": []
      }
    ],
    "expected_payments": [
      {
        "id": 16792,
        "amount": "500.00",
        "payment_date": "2026-01-28",
        "payment_type": 1,
        "payment_type_name": "Other (In)",
        "payment_type_obj": {
          "id": 1,
          "name": "Other",
          "type": "In",
          "keywords": ""
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 6,
        "bank_name": "BA",
        "apartment": 59,
        "apartment_name": "780-306",
        "booking": null,
        "tenant_name": "",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306]",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16792,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 70.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $0.00 [20] | Date: diff 0 days [20] | Apartment: 780-306 [20] | Tenant: (none) [0] | Bank: BA [0] | Payment Type: Other (In) [5] | Payment Method: Wire [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 0.0,
          "payment_type": 5.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $0.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "780-306",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "(none)",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Other (In)",
            "score": 5.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Wire",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "high",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 500.0, \"date_from\": \"2026-01-28\", \"date_to\": \"2026-01-28\", \"direction\": \"In\", \"apartment_name\": \"780-306\", \"apartment_candidates\": [\"780-306\"], \"tenant_name\": null, \"tenant_candidates\": [], \"payment_method_name\": \"Wire\", \"payment_method_candidates\": [], \"bank_name\": \"BA\", \"bank_candidates\": [], \"notes_combined\": \"Variation 16 - Utility payment for 780-306\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16714, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"TEST_NOT_BA_BANK\", \"payment_method\": \"Wire\", \"notes\": \"DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variat\"}, {\"db_id\": 16792, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306]\"}, {\"db_id\": 16716, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}, {\"db_id\": 16794, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": \"Michael Steinhardt\", \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16792,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "17_variation_17",
    "test_payment": [
      {
        "id": "bank-tc17",
        "amount": 500.0,
        "payment_date": "2026-01-28",
        "notes": "Variation 17 - Utility payment for 780-306",
        "apartment_name": "780-306",
        "tenant_name": "",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 2,
        "payment_type_type": "Out",
        "apartment": 59,
        "merged_payment_key": "01/28/2026500Variation 17 - Utility payment for 780-306",
        "is_merged": false,
        "apartment_candidates": [
          "780-306"
        ],
        "tenant_candidates": []
      }
    ],
    "expected_payments": [
      {
        "id": 16788,
        "amount": "500.00",
        "payment_date": "2026-01-28",
        "payment_type": 2,
        "payment_type_name": "Other (Out)",
        "payment_type_obj": {
          "id": 2,
          "name": "Other",
          "type": "Out",
          "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 20,
        "bank_name": "TEST_NOT_BA_BANK",
        "apartment": 59,
        "apartment_name": "780-306",
        "booking": null,
        "tenant_name": "",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility payment for 780-306]",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 15146,
          "amount": "2900.00",
          "payment_date": "2026-02-01",
          "payment_type": 21,
          "payment_type_name": "Rent (Out)",
          "payment_type_obj": {
            "id": 21,
            "name": "Rent",
            "type": "Out",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 76,
          "apartment_name": "630-210",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "",
          "keywords": ""
        },
        "score": 45.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $2400.00 [0] | Date: diff 4 days [20] | Apartment: 630-210 [0] | Tenant: (none) [0] | Bank: BA [0] | Payment Type: Rent (Out) [20] | Payment Method: Wire [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 0.0,
          "date": 20.0,
          "apartment": 0.0,
          "tenant": 0.0,
          "payment_type": 20.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $2400.00",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 4 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "630-210",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "(none)",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Rent (Out)",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Wire",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "medium",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 500.0, \"date_from\": \"2026-01-28\", \"date_to\": \"2026-01-28\", \"direction\": \"Out\", \"apartment_name\": \"780-306\", \"apartment_candidates\": [\"780-306\"], \"tenant_name\": null, \"tenant_candidates\": [], \"payment_method_name\": \"Wire\", \"payment_method_candidates\": [], \"bank_name\": \"BA\", \"bank_candidates\": [], \"notes_combined\": \"Variation 17 - Utility payment for 780-306\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16710, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility paymen\"}, {\"db_id\": 16788, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"TEST_NOT_BA_BANK\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility paymen\"}, {\"db_id\": 16704, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306\"}, {\"db_id\": 16705, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}, {\"db_id\": 16711, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}, {\"db_id\": 16789, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16788,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 2,
          "payment_type_name": "Other (Out)",
          "payment_type_obj": {
            "id": 2,
            "name": "Other",
            "type": "Out",
            "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 20,
          "bank_name": "TEST_NOT_BA_BANK",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "18_variation_18",
    "test_payment": [
      {
        "id": "bank-tc18",
        "amount": 500.0,
        "payment_date": "2026-01-28",
        "notes": "Variation 18 - Utility payment for 780-306",
        "apartment_name": "780-306",
        "tenant_name": "",
        "bank": 20,
        "bank_name": "TEST_NOT_BA_BANK",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 1,
        "payment_type_type": "In",
        "apartment": 59,
        "merged_payment_key": "01/28/2026500Variation 18 - Utility payment for 780-306",
        "is_merged": false,
        "apartment_candidates": [
          "780-306"
        ],
        "tenant_candidates": []
      }
    ],
    "expected_payments": [
      {
        "id": 16792,
        "amount": "500.00",
        "payment_date": "2026-01-28",
        "payment_type": 1,
        "payment_type_name": "Other (In)",
        "payment_type_obj": {
          "id": 1,
          "name": "Other",
          "type": "In",
          "keywords": ""
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 6,
        "bank_name": "BA",
        "apartment": 59,
        "apartment_name": "780-306",
        "booking": null,
        "tenant_name": "",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variation 16 - Utility payment for 780-306]",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16792,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variation 16 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 70.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $0.00 [20] | Date: diff 0 days [20] | Apartment: 780-306 [20] | Tenant: (none) [0] | Bank: BA [0] | Payment Type: Other (In) [5] | Payment Method: Wire [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 0.0,
          "payment_type": 5.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $0.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "780-306",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "(none)",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Other (In)",
            "score": 5.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Wire",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "high",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 500.0, \"date_from\": \"2026-01-28\", \"date_to\": \"2026-01-28\", \"direction\": \"In\", \"apartment_name\": \"780-306\", \"apartment_candidates\": [\"780-306\"], \"tenant_name\": null, \"tenant_candidates\": [], \"payment_method_name\": \"Wire\", \"payment_method_candidates\": [], \"bank_name\": \"TEST_NOT_BA_BANK\", \"bank_candidates\": [], \"notes_combined\": \"Variation 18 - Utility payment for 780-306\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16714, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"TEST_NOT_BA_BANK\", \"payment_method\": \"Wire\", \"notes\": \"DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variat\"}, {\"db_id\": 16792, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variat\"}, {\"db_id\": 16716, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}, {\"db_id\": 16794, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": \"Michael Steinhardt\", \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16792,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variation 16 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "19_variation_19",
    "test_payment": [
      {
        "id": "bank-tc19",
        "amount": 500.0,
        "payment_date": "2026-01-28",
        "notes": "Variation 19 - Utility payment for 780-306",
        "apartment_name": "780-306",
        "tenant_name": "",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 2,
        "payment_type_type": "Out",
        "apartment": 59,
        "merged_payment_key": "01/28/2026500Variation 19 - Utility payment for 780-306",
        "is_merged": false,
        "apartment_candidates": [
          "780-306"
        ],
        "tenant_candidates": []
      }
    ],
    "expected_payments": [
      {
        "id": 16788,
        "amount": "500.00",
        "payment_date": "2026-01-28",
        "payment_type": 2,
        "payment_type_name": "Other (Out)",
        "payment_type_obj": {
          "id": 2,
          "name": "Other",
          "type": "Out",
          "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 6,
        "bank_name": "BA",
        "apartment": 59,
        "apartment_name": "780-306",
        "booking": null,
        "tenant_name": "",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility payment for 780-306] [Variation 17 - Utility payment for 780-306]",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16788,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 2,
          "payment_type_name": "Other (Out)",
          "payment_type_obj": {
            "id": 2,
            "name": "Other",
            "type": "Out",
            "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility payment for 780-306] [Variation 17 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 70.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $0.00 [20] | Date: diff 0 days [20] | Apartment: 780-306 [20] | Tenant: (none) [0] | Bank: BA [0] | Payment Type: Other (Out) [5] | Payment Method: Wire [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 0.0,
          "payment_type": 5.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $0.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "780-306",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "(none)",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Other (Out)",
            "score": 5.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Wire",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "high",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 500.0, \"date_from\": \"2026-01-28\", \"date_to\": \"2026-01-28\", \"direction\": \"Out\", \"apartment_name\": \"780-306\", \"apartment_candidates\": [\"780-306\"], \"tenant_name\": null, \"tenant_candidates\": [], \"payment_method_name\": \"Wire\", \"payment_method_candidates\": [], \"bank_name\": \"BA\", \"bank_candidates\": [], \"notes_combined\": \"Variation 19 - Utility payment for 780-306\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16710, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility paymen\"}, {\"db_id\": 16788, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility paymen\"}, {\"db_id\": 16704, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306\"}, {\"db_id\": 16705, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}, {\"db_id\": 16711, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}, {\"db_id\": 16789, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16788,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 2,
          "payment_type_name": "Other (Out)",
          "payment_type_obj": {
            "id": 2,
            "name": "Other",
            "type": "Out",
            "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility payment for 780-306] [Variation 17 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "20_variation_20",
    "test_payment": [
      {
        "id": "bank-tc20",
        "amount": 500.0,
        "payment_date": "2026-01-28",
        "notes": "Variation 20 - Utility payment for 780-306",
        "apartment_name": "780-306",
        "tenant_name": "Jane Keyword",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 1,
        "payment_type_type": "In",
        "apartment": 59,
        "merged_payment_key": "01/28/2026500Variation 20 - Utility payment for 780-306",
        "is_merged": false,
        "apartment_candidates": [
          "780-306"
        ],
        "tenant_candidates": [
          "Jane Keyword"
        ]
      }
    ],
    "expected_payments": [
      {
        "id": 16792,
        "amount": "500.00",
        "payment_date": "2026-01-28",
        "payment_type": 1,
        "payment_type_name": "Other (In)",
        "payment_type_obj": {
          "id": 1,
          "name": "Other",
          "type": "In",
          "keywords": ""
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 20,
        "bank_name": "TEST_NOT_BA_BANK",
        "apartment": 59,
        "apartment_name": "780-306",
        "booking": null,
        "tenant_name": "",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variation 16 - Utility payment for 780-306] [Variation 18 - Utility payment for 780-306]",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16792,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 20,
          "bank_name": "TEST_NOT_BA_BANK",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variation 16 - Utility payment for 780-306] [Variation 18 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 40.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $0.00 [20] | Date: diff 0 days [20] | Apartment: 780-306 [20] | Tenant: (none) [0] | Payment Type: Other (In) [5] | Payment Method: Wire [5] | Keywords: (none) [0] | Bank: not BA (TEST_NOT_BA_BANK) [-30]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 0.0,
          "payment_type": 5.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": -30.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $0.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "780-306",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "(none)",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Other (In)",
            "score": 5.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Wire",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [
          {
            "field": "bank",
            "label": "Bank",
            "value": "not BA (TEST_NOT_BA_BANK)",
            "penalty": -30.0
          }
        ],
        "matched_keywords": [],
        "quality": "medium",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 500.0, \"date_from\": \"2026-01-28\", \"date_to\": \"2026-01-28\", \"direction\": \"In\", \"apartment_name\": \"780-306\", \"apartment_candidates\": [\"780-306\"], \"tenant_name\": \"Jane Keyword\", \"tenant_candidates\": [\"Jane Keyword\"], \"payment_method_name\": \"Wire\", \"payment_method_candidates\": [], \"bank_name\": \"BA\", \"bank_candidates\": [], \"notes_combined\": \"Variation 20 - Utility payment for 780-306\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16714, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"TEST_NOT_BA_BANK\", \"payment_method\": \"Wire\", \"notes\": \"DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variat\"}, {\"db_id\": 16792, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"TEST_NOT_BA_BANK\", \"payment_method\": \"Wire\", \"notes\": \"DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variat\"}, {\"db_id\": 16716, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}, {\"db_id\": 16794, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": \"Michael Steinhardt\", \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16792,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 20,
          "bank_name": "TEST_NOT_BA_BANK",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variation 16 - Utility payment for 780-306] [Variation 18 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "21_variation_21",
    "test_payment": [
      {
        "id": "bank-tc21",
        "amount": 500.0,
        "payment_date": "2026-01-28",
        "notes": "Variation 21 - Utility payment for 780-306",
        "apartment_name": "PH-402",
        "tenant_name": "",
        "bank": 20,
        "bank_name": "TEST_NOT_BA_BANK",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 2,
        "payment_type_type": "Out",
        "apartment": 91,
        "merged_payment_key": "01/28/2026500Variation 21 - Utility payment for 780-306",
        "is_merged": false,
        "apartment_candidates": [
          "PH-402",
          "780-306"
        ],
        "tenant_candidates": []
      }
    ],
    "expected_payments": [
      {
        "id": 16788,
        "amount": "500.00",
        "payment_date": "2026-01-28",
        "payment_type": 2,
        "payment_type_name": "Other (Out)",
        "payment_type_obj": {
          "id": 2,
          "name": "Other",
          "type": "Out",
          "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 6,
        "bank_name": "BA",
        "apartment": 59,
        "apartment_name": "780-306",
        "booking": null,
        "tenant_name": "",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility payment for 780-306] [Variation 17 - Utility payment for 780-306] [Variation 19 - Utility payment for 780-306]",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16788,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 2,
          "payment_type_name": "Other (Out)",
          "payment_type_obj": {
            "id": 2,
            "name": "Other",
            "type": "Out",
            "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility payment for 780-306] [Variation 17 - Utility payment for 780-306] [Variation 19 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 70.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $0.00 [20] | Date: diff 0 days [20] | Apartment: 780-306 [20] | Tenant: (none) [0] | Bank: BA [0] | Payment Type: Other (Out) [5] | Payment Method: Wire [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 0.0,
          "payment_type": 5.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $0.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "780-306",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "(none)",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Other (Out)",
            "score": 5.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Wire",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "high",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 500.0, \"date_from\": \"2026-01-28\", \"date_to\": \"2026-01-28\", \"direction\": \"Out\", \"apartment_name\": null, \"apartment_candidates\": [\"PH-402\", \"780-306\"], \"tenant_name\": null, \"tenant_candidates\": [], \"payment_method_name\": \"Wire\", \"payment_method_candidates\": [], \"bank_name\": \"TEST_NOT_BA_BANK\", \"bank_candidates\": [], \"notes_combined\": \"Variation 21 - Utility payment for 780-306\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16710, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility paymen\"}, {\"db_id\": 16788, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility paymen\"}, {\"db_id\": 16704, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306\"}, {\"db_id\": 16705, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}, {\"db_id\": 16711, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}, {\"db_id\": 16789, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16788,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 2,
          "payment_type_name": "Other (Out)",
          "payment_type_obj": {
            "id": 2,
            "name": "Other",
            "type": "Out",
            "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility payment for 780-306] [Variation 17 - Utility payment for 780-306] [Variation 19 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "22_variation_22",
    "test_payment": [
      {
        "id": "bank-tc22",
        "amount": 500.0,
        "payment_date": "2026-01-28",
        "notes": "Variation 22 - Utility payment for 780-306 garage",
        "apartment_name": "780-306",
        "tenant_name": "",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 1,
        "payment_type_type": "In",
        "apartment": 59,
        "merged_payment_key": "01/28/2026500Variation 22 - Utility payment for 780-306 garage",
        "is_merged": false,
        "apartment_candidates": [
          "780-306"
        ],
        "tenant_candidates": []
      }
    ],
    "expected_payments": [
      {
        "id": 16792,
        "amount": "500.00",
        "payment_date": "2026-01-28",
        "payment_type": 1,
        "payment_type_name": "Other (In)",
        "payment_type_obj": {
          "id": 1,
          "name": "Other",
          "type": "In",
          "keywords": ""
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 6,
        "bank_name": "BA",
        "apartment": 59,
        "apartment_name": "780-306",
        "booking": null,
        "tenant_name": "",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variation 16 - Utility payment for 780-306] [Variation 18 - Utility payment for 780-306] [Variation 20 - Utility payment for 780-306]",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16792,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variation 16 - Utility payment for 780-306] [Variation 18 - Utility payment for 780-306] [Variation 20 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 70.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $0.00 [20] | Date: diff 0 days [20] | Apartment: 780-306 [20] | Tenant: (none) [0] | Bank: BA [0] | Payment Type: Other (In) [5] | Payment Method: Wire [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 0.0,
          "payment_type": 5.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $0.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "780-306",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "(none)",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Other (In)",
            "score": 5.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Wire",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "high",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 500.0, \"date_from\": \"2026-01-28\", \"date_to\": \"2026-01-28\", \"direction\": \"In\", \"apartment_name\": \"780-306\", \"apartment_candidates\": [\"780-306\"], \"tenant_name\": null, \"tenant_candidates\": [], \"payment_method_name\": \"Wire\", \"payment_method_candidates\": [], \"bank_name\": \"BA\", \"bank_candidates\": [], \"notes_combined\": \"Variation 22 - Utility payment for 780-306 garage\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16714, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"TEST_NOT_BA_BANK\", \"payment_method\": \"Wire\", \"notes\": \"DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variat\"}, {\"db_id\": 16792, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variat\"}, {\"db_id\": 16716, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}, {\"db_id\": 16794, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": \"Michael Steinhardt\", \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16792,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variation 16 - Utility payment for 780-306] [Variation 18 - Utility payment for 780-306] [Variation 20 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "23_variation_23",
    "test_payment": [
      {
        "id": "bank-tc23",
        "amount": 500.0,
        "payment_date": "2026-01-28",
        "notes": "Variation 23 - Utility payment for 780-306",
        "apartment_name": "780-306",
        "tenant_name": "",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 2,
        "payment_type_type": "Out",
        "apartment": 59,
        "merged_payment_key": "01/28/2026500Variation 23 - Utility payment for 780-306",
        "is_merged": false,
        "apartment_candidates": [
          "780-306"
        ],
        "tenant_candidates": []
      }
    ],
    "expected_payments": [
      {
        "id": 16788,
        "amount": "500.00",
        "payment_date": "2026-01-28",
        "payment_type": 2,
        "payment_type_name": "Other (Out)",
        "payment_type_obj": {
          "id": 2,
          "name": "Other",
          "type": "Out",
          "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 20,
        "bank_name": "TEST_NOT_BA_BANK",
        "apartment": 59,
        "apartment_name": "780-306",
        "booking": null,
        "tenant_name": "",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility payment for 780-306] [Variation 17 - Utility payment for 780-306] [Variation 19 - Utility payment for 780-306] [Variation 21 - Utility payment for 780-306]",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 15146,
          "amount": "2900.00",
          "payment_date": "2026-02-01",
          "payment_type": 21,
          "payment_type_name": "Rent (Out)",
          "payment_type_obj": {
            "id": 21,
            "name": "Rent",
            "type": "Out",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 76,
          "apartment_name": "630-210",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "",
          "keywords": ""
        },
        "score": 45.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $2400.00 [0] | Date: diff 4 days [20] | Apartment: 630-210 [0] | Tenant: (none) [0] | Bank: BA [0] | Payment Type: Rent (Out) [20] | Payment Method: Wire [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 0.0,
          "date": 20.0,
          "apartment": 0.0,
          "tenant": 0.0,
          "payment_type": 20.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $2400.00",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 4 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "630-210",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "(none)",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Rent (Out)",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Wire",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "medium",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 500.0, \"date_from\": \"2026-01-28\", \"date_to\": \"2026-01-28\", \"direction\": \"Out\", \"apartment_name\": \"780-306\", \"apartment_candidates\": [\"780-306\"], \"tenant_name\": null, \"tenant_candidates\": [], \"payment_method_name\": \"Wire\", \"payment_method_candidates\": [], \"bank_name\": \"BA\", \"bank_candidates\": [], \"notes_combined\": \"Variation 23 - Utility payment for 780-306\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16710, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility paymen\"}, {\"db_id\": 16788, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"TEST_NOT_BA_BANK\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility paymen\"}, {\"db_id\": 16704, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306\"}, {\"db_id\": 16705, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}, {\"db_id\": 16711, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}, {\"db_id\": 16789, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16788,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 2,
          "payment_type_name": "Other (Out)",
          "payment_type_obj": {
            "id": 2,
            "name": "Other",
            "type": "Out",
            "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 20,
          "bank_name": "TEST_NOT_BA_BANK",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility payment for 780-306] [Variation 17 - Utility payment for 780-306] [Variation 19 - Utility payment for 780-306] [Variation 21 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "24_variation_24",
    "test_payment": [
      {
        "id": "bank-tc24",
        "amount": 500.0,
        "payment_date": "2026-01-28",
        "notes": "Variation 24 - Utility payment for 780-306",
        "apartment_name": "780-306",
        "tenant_name": "",
        "bank": 20,
        "bank_name": "TEST_NOT_BA_BANK",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 1,
        "payment_type_type": "In",
        "apartment": 59,
        "merged_payment_key": "01/28/2026500Variation 24 - Utility payment for 780-306",
        "is_merged": false,
        "apartment_candidates": [
          "780-306"
        ],
        "tenant_candidates": []
      }
    ],
    "expected_payments": [
      {
        "id": 16792,
        "amount": "500.00",
        "payment_date": "2026-01-28",
        "payment_type": 1,
        "payment_type_name": "Other (In)",
        "payment_type_obj": {
          "id": 1,
          "name": "Other",
          "type": "In",
          "keywords": ""
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 6,
        "bank_name": "BA",
        "apartment": 59,
        "apartment_name": "780-306",
        "booking": null,
        "tenant_name": "",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variation 16 - Utility payment for 780-306] [Variation 18 - Utility payment for 780-306] [Variation 20 - Utility payment for 780-306] [Variation 22 - Utility payment for 780-306 garage]",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16792,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variation 16 - Utility payment for 780-306] [Variation 18 - Utility payment for 780-306] [Variation 20 - Utility payment for 780-306] [Variation 22 - Utility payment for 780-306 garage]",
          "keywords": ""
        },
        "score": 70.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $0.00 [20] | Date: diff 0 days [20] | Apartment: 780-306 [20] | Tenant: (none) [0] | Bank: BA [0] | Payment Type: Other (In) [5] | Payment Method: Wire [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 0.0,
          "payment_type": 5.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $0.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "780-306",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "(none)",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Other (In)",
            "score": 5.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Wire",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "high",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 500.0, \"date_from\": \"2026-01-28\", \"date_to\": \"2026-01-28\", \"direction\": \"In\", \"apartment_name\": \"780-306\", \"apartment_candidates\": [\"780-306\"], \"tenant_name\": null, \"tenant_candidates\": [], \"payment_method_name\": \"Wire\", \"payment_method_candidates\": [], \"bank_name\": \"TEST_NOT_BA_BANK\", \"bank_candidates\": [], \"notes_combined\": \"Variation 24 - Utility payment for 780-306\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16714, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"TEST_NOT_BA_BANK\", \"payment_method\": \"Wire\", \"notes\": \"DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variat\"}, {\"db_id\": 16792, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variat\"}, {\"db_id\": 16716, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}, {\"db_id\": 16794, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": \"Michael Steinhardt\", \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16792,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variation 16 - Utility payment for 780-306] [Variation 18 - Utility payment for 780-306] [Variation 20 - Utility payment for 780-306] [Variation 22 - Utility payment for 780-306 garage]",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "25_variation_25",
    "test_payment": [
      {
        "id": "bank-tc25",
        "amount": 500.0,
        "payment_date": "2026-01-28",
        "notes": "Variation 25 - Utility payment for 780-306",
        "apartment_name": "780-306",
        "tenant_name": "Jane Keyword",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 2,
        "payment_type_type": "Out",
        "apartment": 59,
        "merged_payment_key": "01/28/2026500Variation 25 - Utility payment for 780-306",
        "is_merged": false,
        "apartment_candidates": [
          "780-306"
        ],
        "tenant_candidates": [
          "Jane Keyword"
        ]
      }
    ],
    "expected_payments": [
      {
        "id": 16788,
        "amount": "500.00",
        "payment_date": "2026-01-28",
        "payment_type": 2,
        "payment_type_name": "Other (Out)",
        "payment_type_obj": {
          "id": 2,
          "name": "Other",
          "type": "Out",
          "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 6,
        "bank_name": "BA",
        "apartment": 59,
        "apartment_name": "780-306",
        "booking": null,
        "tenant_name": "",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility payment for 780-306] [Variation 17 - Utility payment for 780-306] [Variation 19 - Utility payment for 780-306] [Variation 21 - Utility payment for 780-306] [Variation 23 - Utility payment for 780-306]",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16788,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 2,
          "payment_type_name": "Other (Out)",
          "payment_type_obj": {
            "id": 2,
            "name": "Other",
            "type": "Out",
            "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility payment for 780-306] [Variation 17 - Utility payment for 780-306] [Variation 19 - Utility payment for 780-306] [Variation 21 - Utility payment for 780-306] [Variation 23 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 70.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $0.00 [20] | Date: diff 0 days [20] | Apartment: 780-306 [20] | Tenant: (none) [0] | Bank: BA [0] | Payment Type: Other (Out) [5] | Payment Method: Wire [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 0.0,
          "payment_type": 5.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $0.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "780-306",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "(none)",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Other (Out)",
            "score": 5.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Wire",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "high",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 500.0, \"date_from\": \"2026-01-28\", \"date_to\": \"2026-01-28\", \"direction\": \"Out\", \"apartment_name\": \"780-306\", \"apartment_candidates\": [\"780-306\"], \"tenant_name\": \"Jane Keyword\", \"tenant_candidates\": [\"Jane Keyword\"], \"payment_method_name\": \"Wire\", \"payment_method_candidates\": [], \"bank_name\": \"BA\", \"bank_candidates\": [], \"notes_combined\": \"Variation 25 - Utility payment for 780-306\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16710, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility paymen\"}, {\"db_id\": 16788, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility paymen\"}, {\"db_id\": 16704, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306\"}, {\"db_id\": 16705, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}, {\"db_id\": 16711, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}, {\"db_id\": 16789, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16788,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 2,
          "payment_type_name": "Other (Out)",
          "payment_type_obj": {
            "id": 2,
            "name": "Other",
            "type": "Out",
            "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility payment for 780-306] [Variation 17 - Utility payment for 780-306] [Variation 19 - Utility payment for 780-306] [Variation 21 - Utility payment for 780-306] [Variation 23 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "26_variation_26",
    "test_payment": [
      {
        "id": "bank-tc26",
        "amount": 500.0,
        "payment_date": "2026-01-28",
        "notes": "Variation 26 - Utility payment for 780-306",
        "apartment_name": "780-306",
        "tenant_name": "",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 1,
        "payment_type_type": "In",
        "apartment": 59,
        "merged_payment_key": "01/28/2026500Variation 26 - Utility payment for 780-306",
        "is_merged": false,
        "apartment_candidates": [
          "780-306"
        ],
        "tenant_candidates": []
      }
    ],
    "expected_payments": [
      {
        "id": 16792,
        "amount": "500.00",
        "payment_date": "2026-01-28",
        "payment_type": 1,
        "payment_type_name": "Other (In)",
        "payment_type_obj": {
          "id": 1,
          "name": "Other",
          "type": "In",
          "keywords": ""
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 20,
        "bank_name": "TEST_NOT_BA_BANK",
        "apartment": 59,
        "apartment_name": "780-306",
        "booking": null,
        "tenant_name": "",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variation 16 - Utility payment for 780-306] [Variation 18 - Utility payment for 780-306] [Variation 20 - Utility payment for 780-306] [Variation 22 - Utility payment for 780-306 garage] [Variation 24 - Utility payment for 780-306]",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16792,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 20,
          "bank_name": "TEST_NOT_BA_BANK",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variation 16 - Utility payment for 780-306] [Variation 18 - Utility payment for 780-306] [Variation 20 - Utility payment for 780-306] [Variation 22 - Utility payment for 780-306 garage] [Variation 24 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 40.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $0.00 [20] | Date: diff 0 days [20] | Apartment: 780-306 [20] | Tenant: (none) [0] | Payment Type: Other (In) [5] | Payment Method: Wire [5] | Keywords: (none) [0] | Bank: not BA (TEST_NOT_BA_BANK) [-30]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 0.0,
          "payment_type": 5.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": -30.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $0.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "780-306",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "(none)",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Other (In)",
            "score": 5.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Wire",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [
          {
            "field": "bank",
            "label": "Bank",
            "value": "not BA (TEST_NOT_BA_BANK)",
            "penalty": -30.0
          }
        ],
        "matched_keywords": [],
        "quality": "medium",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 500.0, \"date_from\": \"2026-01-28\", \"date_to\": \"2026-01-28\", \"direction\": \"In\", \"apartment_name\": \"780-306\", \"apartment_candidates\": [\"780-306\"], \"tenant_name\": null, \"tenant_candidates\": [], \"payment_method_name\": \"Wire\", \"payment_method_candidates\": [], \"bank_name\": \"BA\", \"bank_candidates\": [], \"notes_combined\": \"Variation 26 - Utility payment for 780-306\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16714, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"TEST_NOT_BA_BANK\", \"payment_method\": \"Wire\", \"notes\": \"DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variat\"}, {\"db_id\": 16792, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"TEST_NOT_BA_BANK\", \"payment_method\": \"Wire\", \"notes\": \"DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variat\"}, {\"db_id\": 16716, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}, {\"db_id\": 16794, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": \"Michael Steinhardt\", \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16792,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 20,
          "bank_name": "TEST_NOT_BA_BANK",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variation 16 - Utility payment for 780-306] [Variation 18 - Utility payment for 780-306] [Variation 20 - Utility payment for 780-306] [Variation 22 - Utility payment for 780-306 garage] [Variation 24 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "27_variation_27",
    "test_payment": [
      {
        "id": "bank-tc27",
        "amount": 500.0,
        "payment_date": "2026-01-28",
        "notes": "Variation 27 - Utility payment for 780-306",
        "apartment_name": "780-306",
        "tenant_name": "",
        "bank": 20,
        "bank_name": "TEST_NOT_BA_BANK",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 2,
        "payment_type_type": "Out",
        "apartment": 59,
        "merged_payment_key": "01/28/2026500Variation 27 - Utility payment for 780-306",
        "is_merged": false,
        "apartment_candidates": [
          "780-306"
        ],
        "tenant_candidates": []
      }
    ],
    "expected_payments": [
      {
        "id": 16788,
        "amount": "500.00",
        "payment_date": "2026-01-28",
        "payment_type": 2,
        "payment_type_name": "Other (Out)",
        "payment_type_obj": {
          "id": 2,
          "name": "Other",
          "type": "Out",
          "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 6,
        "bank_name": "BA",
        "apartment": 59,
        "apartment_name": "780-306",
        "booking": null,
        "tenant_name": "",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility payment for 780-306] [Variation 17 - Utility payment for 780-306] [Variation 19 - Utility payment for 780-306] [Variation 21 - Utility payment for 780-306] [Variation 23 - Utility payment for 780-306] [Variation 25 - Utility payment for 780-306]",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16788,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 2,
          "payment_type_name": "Other (Out)",
          "payment_type_obj": {
            "id": 2,
            "name": "Other",
            "type": "Out",
            "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility payment for 780-306] [Variation 17 - Utility payment for 780-306] [Variation 19 - Utility payment for 780-306] [Variation 21 - Utility payment for 780-306] [Variation 23 - Utility payment for 780-306] [Variation 25 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 70.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $0.00 [20] | Date: diff 0 days [20] | Apartment: 780-306 [20] | Tenant: (none) [0] | Bank: BA [0] | Payment Type: Other (Out) [5] | Payment Method: Wire [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 0.0,
          "payment_type": 5.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $0.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "780-306",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "(none)",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Other (Out)",
            "score": 5.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Wire",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "high",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 500.0, \"date_from\": \"2026-01-28\", \"date_to\": \"2026-01-28\", \"direction\": \"Out\", \"apartment_name\": \"780-306\", \"apartment_candidates\": [\"780-306\"], \"tenant_name\": null, \"tenant_candidates\": [], \"payment_method_name\": \"Wire\", \"payment_method_candidates\": [], \"bank_name\": \"TEST_NOT_BA_BANK\", \"bank_candidates\": [], \"notes_combined\": \"Variation 27 - Utility payment for 780-306\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16710, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility paymen\"}, {\"db_id\": 16788, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility paymen\"}, {\"db_id\": 16704, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306\"}, {\"db_id\": 16705, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}, {\"db_id\": 16711, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}, {\"db_id\": 16789, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16788,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 2,
          "payment_type_name": "Other (Out)",
          "payment_type_obj": {
            "id": 2,
            "name": "Other",
            "type": "Out",
            "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility payment for 780-306] [Variation 17 - Utility payment for 780-306] [Variation 19 - Utility payment for 780-306] [Variation 21 - Utility payment for 780-306] [Variation 23 - Utility payment for 780-306] [Variation 25 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "28_variation_28",
    "test_payment": [
      {
        "id": "bank-tc28",
        "amount": 500.0,
        "payment_date": "2026-01-28",
        "notes": "Variation 28 - Utility payment for 780-306",
        "apartment_name": "PH-402",
        "tenant_name": "",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 1,
        "payment_type_type": "In",
        "apartment": 91,
        "merged_payment_key": "01/28/2026500Variation 28 - Utility payment for 780-306",
        "is_merged": false,
        "apartment_candidates": [
          "PH-402",
          "780-306"
        ],
        "tenant_candidates": []
      }
    ],
    "expected_payments": [
      {
        "id": 16792,
        "amount": "500.00",
        "payment_date": "2026-01-28",
        "payment_type": 1,
        "payment_type_name": "Other (In)",
        "payment_type_obj": {
          "id": 1,
          "name": "Other",
          "type": "In",
          "keywords": ""
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 6,
        "bank_name": "BA",
        "apartment": 59,
        "apartment_name": "780-306",
        "booking": null,
        "tenant_name": "",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variation 16 - Utility payment for 780-306] [Variation 18 - Utility payment for 780-306] [Variation 20 - Utility payment for 780-306] [Variation 22 - Utility payment for 780-306 garage] [Variation 24 - Utility payment for 780-306] [Variation 26 - Utility payment for 780-306]",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16792,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variation 16 - Utility payment for 780-306] [Variation 18 - Utility payment for 780-306] [Variation 20 - Utility payment for 780-306] [Variation 22 - Utility payment for 780-306 garage] [Variation 24 - Utility payment for 780-306] [Variation 26 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 70.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $0.00 [20] | Date: diff 0 days [20] | Apartment: 780-306 [20] | Tenant: (none) [0] | Bank: BA [0] | Payment Type: Other (In) [5] | Payment Method: Wire [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 0.0,
          "payment_type": 5.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $0.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "780-306",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "(none)",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Other (In)",
            "score": 5.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Wire",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "high",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 500.0, \"date_from\": \"2026-01-28\", \"date_to\": \"2026-01-28\", \"direction\": \"In\", \"apartment_name\": null, \"apartment_candidates\": [\"PH-402\", \"780-306\"], \"tenant_name\": null, \"tenant_candidates\": [], \"payment_method_name\": \"Wire\", \"payment_method_candidates\": [], \"bank_name\": \"BA\", \"bank_candidates\": [], \"notes_combined\": \"Variation 28 - Utility payment for 780-306\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16714, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"TEST_NOT_BA_BANK\", \"payment_method\": \"Wire\", \"notes\": \"DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variat\"}, {\"db_id\": 16792, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variat\"}, {\"db_id\": 16716, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}, {\"db_id\": 16794, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": \"Michael Steinhardt\", \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16792,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variation 16 - Utility payment for 780-306] [Variation 18 - Utility payment for 780-306] [Variation 20 - Utility payment for 780-306] [Variation 22 - Utility payment for 780-306 garage] [Variation 24 - Utility payment for 780-306] [Variation 26 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "29_variation_29",
    "test_payment": [
      {
        "id": "bank-tc29",
        "amount": 500.0,
        "payment_date": "2026-01-28",
        "notes": "Variation 29 - Utility payment for 780-306",
        "apartment_name": "780-306",
        "tenant_name": "",
        "bank": 6,
        "bank_name": "BA",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 2,
        "payment_type_type": "Out",
        "apartment": 59,
        "merged_payment_key": "01/28/2026500Variation 29 - Utility payment for 780-306",
        "is_merged": false,
        "apartment_candidates": [
          "780-306"
        ],
        "tenant_candidates": []
      }
    ],
    "expected_payments": [
      {
        "id": 16788,
        "amount": "500.00",
        "payment_date": "2026-01-28",
        "payment_type": 2,
        "payment_type_name": "Other (Out)",
        "payment_type_obj": {
          "id": 2,
          "name": "Other",
          "type": "Out",
          "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 20,
        "bank_name": "TEST_NOT_BA_BANK",
        "apartment": 59,
        "apartment_name": "780-306",
        "booking": null,
        "tenant_name": "",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility payment for 780-306] [Variation 17 - Utility payment for 780-306] [Variation 19 - Utility payment for 780-306] [Variation 21 - Utility payment for 780-306] [Variation 23 - Utility payment for 780-306] [Variation 25 - Utility payment for 780-306] [Variation 27 - Utility payment for 780-306]",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 15146,
          "amount": "2900.00",
          "payment_date": "2026-02-01",
          "payment_type": 21,
          "payment_type_name": "Rent (Out)",
          "payment_type_obj": {
            "id": 21,
            "name": "Rent",
            "type": "Out",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 76,
          "apartment_name": "630-210",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "",
          "keywords": ""
        },
        "score": 45.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $2400.00 [0] | Date: diff 4 days [20] | Apartment: 630-210 [0] | Tenant: (none) [0] | Bank: BA [0] | Payment Type: Rent (Out) [20] | Payment Method: Wire [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 0.0,
          "date": 20.0,
          "apartment": 0.0,
          "tenant": 0.0,
          "payment_type": 20.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $2400.00",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 4 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "630-210",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "(none)",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Rent (Out)",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Wire",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "medium",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 500.0, \"date_from\": \"2026-01-28\", \"date_to\": \"2026-01-28\", \"direction\": \"Out\", \"apartment_name\": \"780-306\", \"apartment_candidates\": [\"780-306\"], \"tenant_name\": null, \"tenant_candidates\": [], \"payment_method_name\": \"Wire\", \"payment_method_candidates\": [], \"bank_name\": \"BA\", \"bank_candidates\": [], \"notes_combined\": \"Variation 29 - Utility payment for 780-306\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16710, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility paymen\"}, {\"db_id\": 16788, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"TEST_NOT_BA_BANK\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility paymen\"}, {\"db_id\": 16704, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility for 780-306\"}, {\"db_id\": 16705, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}, {\"db_id\": 16711, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}, {\"db_id\": 16789, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"Out\", \"payment_type\": \"Other\", \"apartment\": \"999-999\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB utility wrong apt\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16788,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 2,
          "payment_type_name": "Other (Out)",
          "payment_type_obj": {
            "id": 2,
            "name": "Other",
            "type": "Out",
            "keywords": "READ - MEETING, AMERICAN EXPRESS, GODADDY.COM, CONSTITUTIONAL"
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 20,
          "bank_name": "TEST_NOT_BA_BANK",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB utility for 780-306 [Utility payment for 780-306] [Variation 11 - Utility payment for 780-306 garage] [Variation 13 - Utility payment for 780-306] [Variation 15 - Utility payment for 780-306] [Variation 17 - Utility payment for 780-306] [Variation 19 - Utility payment for 780-306] [Variation 21 - Utility payment for 780-306] [Variation 23 - Utility payment for 780-306] [Variation 25 - Utility payment for 780-306] [Variation 27 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  },
  {
    "name": "30_variation_30",
    "test_payment": [
      {
        "id": "bank-tc30",
        "amount": 500.0,
        "payment_date": "2026-01-28",
        "notes": "Variation 30 - Utility payment for 780-306",
        "apartment_name": "780-306",
        "tenant_name": "Jane Keyword",
        "bank": 20,
        "bank_name": "TEST_NOT_BA_BANK",
        "payment_method": 11,
        "payment_method_name": "Wire",
        "payment_type": 1,
        "payment_type_type": "In",
        "apartment": 59,
        "merged_payment_key": "01/28/2026500Variation 30 - Utility payment for 780-306",
        "is_merged": false,
        "apartment_candidates": [
          "780-306"
        ],
        "tenant_candidates": [
          "Jane Keyword"
        ]
      }
    ],
    "expected_payments": [
      {
        "id": 16792,
        "amount": "500.00",
        "payment_date": "2026-01-28",
        "payment_type": 1,
        "payment_type_name": "Other (In)",
        "payment_type_obj": {
          "id": 1,
          "name": "Other",
          "type": "In",
          "keywords": ""
        },
        "payment_method": 11,
        "payment_method_name": "Wire",
        "bank": 6,
        "bank_name": "BA",
        "apartment": 59,
        "apartment_name": "780-306",
        "booking": null,
        "tenant_name": "",
        "payment_status": "Pending",
        "merged_payment_key": "",
        "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variation 16 - Utility payment for 780-306] [Variation 18 - Utility payment for 780-306] [Variation 20 - Utility payment for 780-306] [Variation 22 - Utility payment for 780-306 garage] [Variation 24 - Utility payment for 780-306] [Variation 26 - Utility payment for 780-306] [Variation 28 - Utility payment for 780-306]",
        "keywords": ""
      }
    ],
    "manual_matching": [
      {
        "type": "manual",
        "db_payment": {
          "id": 16792,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variation 16 - Utility payment for 780-306] [Variation 18 - Utility payment for 780-306] [Variation 20 - Utility payment for 780-306] [Variation 22 - Utility payment for 780-306 garage] [Variation 24 - Utility payment for 780-306] [Variation 26 - Utility payment for 780-306] [Variation 28 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 70.0,
        "match_type": "manual_composite",
        "criteria": "Amount: diff $0.00 [20] | Date: diff 0 days [20] | Apartment: 780-306 [20] | Tenant: (none) [0] | Bank: BA [0] | Payment Type: Other (In) [5] | Payment Method: Wire [5] | Keywords: (none) [0]",
        "breakdown": {
          "amount": 20.0,
          "date": 20.0,
          "apartment": 20.0,
          "tenant": 0.0,
          "payment_type": 5.0,
          "payment_method": 5.0,
          "keywords": 0.0,
          "bank_penalty": 0.0
        },
        "breakdown_details": [
          {
            "field": "amount",
            "label": "Amount",
            "value": "diff $0.00",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "date",
            "label": "Date",
            "value": "diff 0 days",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "apartment",
            "label": "Apartment",
            "value": "780-306",
            "score": 20.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "tenant",
            "label": "Tenant",
            "value": "(none)",
            "score": 0.0,
            "max": 20,
            "matched": false
          },
          {
            "field": "bank",
            "label": "Bank",
            "value": "BA",
            "score": 0,
            "max": 0,
            "matched": true
          },
          {
            "field": "payment_type",
            "label": "Payment Type",
            "value": "Other (In)",
            "score": 5.0,
            "max": 20,
            "matched": true
          },
          {
            "field": "payment_method",
            "label": "Payment Method",
            "value": "Wire",
            "score": 5.0,
            "max": 5,
            "matched": true
          },
          {
            "field": "keywords",
            "label": "Keywords",
            "value": "(none)",
            "score": 0.0,
            "max": 50,
            "matched": false
          }
        ],
        "penalties": [],
        "matched_keywords": [],
        "quality": "high",
        "status_penalty": false
      }
    ],
    "full_ai_input_prompt": "You are matching bank file payment selections to DB payments.\nReturn ONLY strict JSON (no markdown, no code fences).\nOutput must be a JSON array of objects: [{db_id:number, score:number(0-100), match_type:string, criteria:string}].\nOnly use db_id values that appear in the provided candidates list.\nPrefer fewer, higher-quality matches; score 0-100.\n\nMatch these payments based on amount, date, description, tenant, apartment, bank, payment method. The amount could be slightly different due to rounding or other factors. date could be also not the same day as the payment date.\n\nComposite selection:\n{\"amount_total\": 500.0, \"date_from\": \"2026-01-28\", \"date_to\": \"2026-01-28\", \"direction\": \"In\", \"apartment_name\": \"780-306\", \"apartment_candidates\": [\"780-306\"], \"tenant_name\": \"Jane Keyword\", \"tenant_candidates\": [\"Jane Keyword\"], \"payment_method_name\": \"Wire\", \"payment_method_candidates\": [], \"bank_name\": \"TEST_NOT_BA_BANK\", \"bank_candidates\": [], \"notes_combined\": \"Variation 30 - Utility payment for 780-306\", \"selected_count\": 1}\n\nDB candidates (choose best matches):\n[{\"db_id\": 16714, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"TEST_NOT_BA_BANK\", \"payment_method\": \"Wire\", \"notes\": \"DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variat\"}, {\"db_id\": 16792, \"amount\": 500.0, \"payment_date\": \"2026-01-28\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"780-306\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Wire\", \"notes\": \"DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variat\"}, {\"db_id\": 16716, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": null, \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}, {\"db_id\": 16794, \"amount\": 600.0, \"payment_date\": \"2026-01-21\", \"type\": \"In\", \"payment_type\": \"Other\", \"apartment\": \"630-205\", \"tenant\": \"Michael Steinhardt\", \"bank\": \"BA\", \"payment_method\": \"Zelle\", \"notes\": \"DB mixed selection total [Mixed methods selection - part 1 | Mixed methods selection - part 2]\"}]",
    "tokens": 22,
    "costs": "",
    "ai_matching_data": [
      {
        "type": "ai",
        "db_payment": {
          "id": 16792,
          "amount": "500.00",
          "payment_date": "2026-01-28",
          "payment_type": 1,
          "payment_type_name": "Other (In)",
          "payment_type_obj": {
            "id": 1,
            "name": "Other",
            "type": "In",
            "keywords": ""
          },
          "payment_method": 11,
          "payment_method_name": "Wire",
          "bank": 6,
          "bank_name": "BA",
          "apartment": 59,
          "apartment_name": "780-306",
          "booking": null,
          "tenant_name": "",
          "payment_status": "Pending",
          "merged_payment_key": "",
          "notes": "DB refund [Wire from vendor - refund] [Variation 10 - Utility payment for 780-306] [Variation 12 - Utility payment for 780-306] [Variation 14 - Utility payment for 780-306] [Variation 16 - Utility payment for 780-306] [Variation 18 - Utility payment for 780-306] [Variation 20 - Utility payment for 780-306] [Variation 22 - Utility payment for 780-306 garage] [Variation 24 - Utility payment for 780-306] [Variation 26 - Utility payment for 780-306] [Variation 28 - Utility payment for 780-306]",
          "keywords": ""
        },
        "score": 95.0,
        "match_type": "ai",
        "criteria": "planned test ai match"
      }
    ]
  }
]